LAMMPS (14 May 2021)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# 3d Lennard-Jones NVT

#NOTE: the variable "rho" is read from the command line argument:
#  E.G., "lmp_serial -in foo -var rho bar"
#  foo = input filename
#  bar = input value for variable rho

#Essential definitions
units           lj                                      #Units type: Lennard-Jones
atom_style      atomic                                  #Atom Style: Atoms

#Run Parameters
variable        ext_temp equal 1.50                     #Specify the thermostat Temperature
variable        Nevery equal 20                         #Specify the distance (in timesteps) between samples for computing ensemble averages
                                                        #  (Interval between samples in a block)
variable        Nrepeat equal 50                        #Specify the number of samples per output  of thermodynamic averages
                                                        #  (Samples per block output)
variable        Nfreq equal ${Nevery}*${Nrepeat}        #Specify the dump interval (in timesteps)
variable        Nfreq equal 20*${Nrepeat}        
variable        Nfreq equal 20*50        
                                                        #  (Some people call these blocks)
variable        nrun equal 1000000                      #Specify the MD run length (in timesteps
variable        Tdamp equal 0.500                       #Specify the Thermostat damping parameter (in time units ; not timesteps)
variable        cfg_seed equal 45232                    #Seed integer for generating the initial, random configuration
variable        vel_seed equal 87287                    #Seed integer for generating the initial, random velocities

#System Size: Set Nmols and density, get volume
variable        Nmols equal 100                         #Specify number of LJ molecules
variable        density equal ${rho}                    #Specify simulation density from a command-line argument
variable        density equal 0.001                    
variable        L equal (${Nmols}/${density})^(1.0/3.0)
variable        L equal (100/${density})^(1.0/3.0)
variable        L equal (100/0.001)^(1.0/3.0)
                                                        #Cubic system dimensions selected based on Nmols and density

#System Volume
boundary        p p p                                   #Specify Periodic boundary conditions at all system boundaries
region          box block 0.0 ${L} 0.0 ${L} 0.0 ${L}    #Specify a cubic simulation box with dimensions L
region          box block 0.0 46.4158883361278 0.0 ${L} 0.0 ${L}    
region          box block 0.0 46.4158883361278 0.0 46.4158883361278 0.0 ${L}    
region          box block 0.0 46.4158883361278 0.0 46.4158883361278 0.0 46.4158883361278    
create_box      1 box                                   #Create the box
Created orthogonal box = (0.0000000 0.0000000 0.0000000) to (46.415888 46.415888 46.415888)
  2 by 2 by 2 MPI processor grid
create_atoms    1 random ${Nmols} ${cfg_seed} NULL      #Create an initial configuration randomly
create_atoms    1 random 100 ${cfg_seed} NULL      
create_atoms    1 random 100 45232 NULL      
Created 100 atoms
  create_atoms CPU = 0.000 seconds

#Molecular Model
# NOTE: This block must be after the "System Volume" section
pair_style      lj/cut 2.5                              #Pair potential is Lennard-Jones
                                                        #  Truncation radius is 2.5sigma
pair_coeff      1 1 1.0 1.0                             #Pure Lennard-Jones, use sigma=1, epsilon=1
mass            1 1.0                                   #Pure Lennard-Jones, use mass=1

#Neighbor List
neighbor        0.3 bin                                 #Specify the skin distance (padding beyond the cutoff)
neigh_modify    delay 0 every 20 check no               #Adjust the default neighbor list:
                                                        #  (delay 0)
                                                        #  (every 20)
                                                        #  (check no)
#Initial Velocities
velocity        all create ${ext_temp} ${vel_seed} loop geom
velocity        all create 1.5 ${vel_seed} loop geom
velocity        all create 1.5 87287 loop geom
                                                        #Create an initial velocity distribution using the specified
                                                        #  external temperature

#Relax the initial configuration
minimize        1.0E-4 1.0E-6 1000 100000               #Relax the initial configuration and velocities
WARNING: Using 'neigh_modify every 1 delay 0 check yes' setting during minimization (src/min.cpp:189)
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 2.8
  ghost atom cutoff = 2.8
  binsize = 1.4, bins = 34 34 34
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.228 | 4.228 | 4.228 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0          1.5 -0.00017452319            0    2.2273255 0.0014846525 
      11          1.5 -0.0099999476            0    2.2175001 0.0014849086 
Loop time of 0.000784018 on 8 procs for 11 steps with 100 atoms

60.6% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
    -0.000174523188761303 -0.009999911087497 -0.00999994756922083
  Force two-norm initial, final = 0.059642203 0.034526792
  Force max component initial, final = 0.034157681 0.019773836
  Final line search alpha, max atom move = 1.0000000 0.019773836
  Iterations, force evaluations = 11 28

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.4651e-06 | 6.5105e-06 | 7.846e-06  |   0.0 |  0.83
Neigh   | 4.7823e-05 | 5.2716e-05 | 5.9232e-05 |   0.0 |  6.72
Comm    | 0.00024814 | 0.00026789 | 0.0002771  |   0.0 | 34.17
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.0004569  |            |       | 58.28

Nlocal:        12.5000 ave          17 max           8 min
Histogram: 1 0 2 0 1 0 2 1 0 1
Nghost:        11.8750 ave          16 max           3 min
Histogram: 1 0 0 0 0 0 3 1 1 2
Neighs:       0.250000 ave           1 max           0 min
Histogram: 6 0 0 0 0 0 0 0 0 2

Total # of neighbors = 2
Ave neighs/atom = 0.020000000
Neighbor list builds = 4
Dangerous builds not checked
                                                        #  Energy tolerance = 1.0E-4
                                                        #  Force tolerance = 1.0E-6
                                                        #  Maximum number of iterations = 1000
                                                        #  Maximum number of force/energy evaluations = 100000

#Ensemble Setup
fix		1 all nvt temp ${ext_temp} ${ext_temp} ${Tdamp}
fix		1 all nvt temp 1.5 ${ext_temp} ${Tdamp}
fix		1 all nvt temp 1.5 1.5 ${Tdamp}
fix		1 all nvt temp 1.5 1.5 0.5
# Previous line specifies: NVT ensemble, thermostatted by Nose-Hoover a chained thermostat, set at temperature $ext_temp

#Output
variable        PotentialEnergy equal epair             #Call the intermolecular potential energy $epair
variable        Pressure equal press                    #Call the pressure $press
variable        Temperature equal temp                  #Call the instantaneous temperature $temp
fix             2 all ave/time ${Nevery} ${Nrepeat} ${Nfreq} v_Temperature v_PotentialEnergy v_Pressure file out/ave.dens_${rho}.out
fix             2 all ave/time 20 ${Nrepeat} ${Nfreq} v_Temperature v_PotentialEnergy v_Pressure file out/ave.dens_${rho}.out
fix             2 all ave/time 20 50 ${Nfreq} v_Temperature v_PotentialEnergy v_Pressure file out/ave.dens_${rho}.out
fix             2 all ave/time 20 50 1000 v_Temperature v_PotentialEnergy v_Pressure file out/ave.dens_${rho}.out
fix             2 all ave/time 20 50 1000 v_Temperature v_PotentialEnergy v_Pressure file out/ave.dens_0.001.out
thermo          10000                                   #Specify the interval between screen output of thermodynamic averages
thermo_style    custom step temp epair press            #Format for screen output of thermodynamics
                                                        #  (MD step, temperature, potential energy, pressure)

#Run it!
run             ${nrun}                                 #Run the simulation
run             1000000                                 
Per MPI rank memory allocation (min/avg/max) = 2.603 | 2.603 | 2.603 Mbytes
Step Temp E_pair Press 
      11          1.5 -0.0099999476 0.0014849086 
   10000    1.3681479 -0.0066012862 0.0013432714 
   20000    1.7462538 -0.0014169429 0.0017260656 
   30000    1.7058695 -0.00097239157 0.0016868832 
   40000    1.5649855 -0.0070867523 0.0015367052 
   50000    1.5380923 -0.011111491 0.0015220625 
   60000    1.4849336  -0.00481493 0.0014620216 
   70000    1.6006353 -0.0019217994 0.0015809126 
   80000    1.5439337 -0.0024180817 0.0015238555 
   90000    1.3074291 -0.0009638707 0.0013744797 
  100000    1.4471416 -0.0082677917 0.0014214647 
  110000    1.5083313 0.0073004004  0.001680553 
  120000    1.2883857 -0.013539522 0.0012553366 
  130000    1.5471675 -0.0025754645 0.0015268673 
  140000    1.4065427            0 0.0013924773 
  150000    1.6985869 -0.0019796811 0.0016777404 
  160000     1.427758 -0.001236446 0.0014110891 
  170000    1.4740848 -0.0011040501 0.0014571584 
  180000    1.5356009 -0.0021925583  0.001515971 
  190000    1.3790005 -0.0099849959 0.0013506316 
  200000    1.1434851 -0.0065234576 0.0011950286 
  210000       1.4832 -0.0093947958  0.001453732 
  220000    1.6770321 -0.020877663 0.0016319373 
  230000    1.3556914 -0.0039270684 0.0013346498 
  240000    1.3042415 -0.0071866724 0.0012790005 
  250000    1.4596936 -0.0012209158  0.001442692 
  260000    1.4655546 -0.0091241509 0.0014354252 
  270000    1.4277275 -0.010247422 0.0014272316 
  280000    1.4621717 -0.018242542 0.0014334533 
  290000    1.4383682 -0.0028174408 0.0014187507 
  300000    1.3866838 -0.0041926062 0.0013649465 
  310000    1.5190311 -0.020371702 0.0015044525 
  320000    1.7700739 -0.00033282259 0.0017517131 
  330000    1.6674068 -0.011558106 0.0016502364 
  340000    1.6461417 -0.0058980134 0.0016204695 
  350000    1.4668747 -0.00030326507 0.0014516041 
  360000    1.5908655 -0.0037656929 0.0015677354 
  370000    1.5646165 -0.011128543 0.0015427811 
  380000    1.3514553 -0.001607402 0.0013347838 
  390000    1.6253452 -0.00039419774 0.0016083113 
  400000    1.2770265 -0.010936839 0.0012479356 
  410000      1.48213 -0.0059677681 0.0014564135 
  420000    1.3892428 -0.00067812147 0.0013740076 
  430000    1.8754483 -0.012228941 0.0018340375 
  440000    1.4332504 -0.00023313139 0.0014184543 
  450000    1.5893205 -0.0020079562 0.0015694667 
  460000    1.4265439 -0.0014661073 0.0014093858 
  470000    1.6510506 -0.0013944965 0.0016317967 
  480000    1.6576656 -0.013988183 0.0016597309 
  490000     1.448743 -0.013641416  0.001421503 
  500000    1.4342461 -0.0082969068 0.0014053263 
  510000    1.4569936 -0.010687571 0.0014509358 
  520000    1.7016293 -0.0081015184 0.0016714028 
  530000    1.4835509  0.010932064 0.0016505796 
  540000    1.3661593 -0.0070980199  0.001429641 
  550000    1.3808616 -0.020612698 0.0013515553 
  560000    1.4623809            0 0.0014477571 
  570000    1.4161969 -0.0072981322 0.0013901616 
  580000    1.5421844 -0.0083617316  0.001513477 
  590000    1.6117249 -0.015095243 0.0015699459 
  600000    1.6947167 -0.017050509 0.0016531703 
  610000    1.4395414 -0.015287651 0.0014639197 
  620000    1.3571728 -0.0070530841 0.0013813833 
  630000    1.5220455 -0.003135248 0.0015007132 
  640000    1.6139779 -0.017795306 0.0016126226 
  650000    1.4316519 -0.0096655631  0.001453894 
  660000    1.5184312 -0.019369042 0.0014863232 
  670000     1.432605 -0.0063125746  0.001408159 
  680000    1.6864629  -0.01225361 0.0016498882 
  690000    1.6757652 -0.0056023261 0.0016488044 
  700000    1.4468934 -0.0069212049 0.0014221058 
  710000    1.4305025 -0.0026508464 0.0014110977 
  720000    1.4601688 -0.00084629915 0.0014438929 
  730000    1.5456442 -0.011780195 0.0015208665 
  740000    1.7453526  -0.01000493 0.0017165099 
  750000    1.3276324 -0.009465863 0.0013377081 
  760000    1.4904752 -0.0065275464  0.001463224 
  770000    1.2810406 -0.0042990316 0.0012600176 
  780000    1.7822565 -0.0088380023 0.0017512451 
  790000    1.6152536 -0.010385897 0.0015843061 
  800000    1.5547144 -0.014242535 0.0015328348 
  810000    1.3570902 -0.0038892589 0.0013359692 
  820000    1.3982291 -0.0067929187 0.0013734706 
  830000    1.6389564 -0.013051746 0.0016025702 
  840000    1.5697411 -0.015387368   0.00158131 
  850000    1.4824131  -0.01111845 0.0014546506 
  860000    1.6615526 -0.0014397091 0.0016420849 
  870000    1.3606135 -0.0056200535 0.0013362924 
  880000    1.5717531 -0.0098876366 0.0015393539 
  890000    1.3733457 -0.0025387193   0.00135468 
  900000    1.4565367 -0.00089627587 0.0014401933 
  910000    1.3054041 -0.0012291802 0.0013873819 
  920000    1.3137288 -0.001410315 0.0012978313 
  930000    1.5066709 -0.0013066049 0.0014890825 
  940000    1.6553061 -0.0010295442 0.0016367141 
  950000    1.5319247  -0.00091551 0.0015148048 
  960000    1.5667701 -0.0059026483   0.00153995 
  970000    1.3492963 -0.017931143 0.0013102687 
  980000     1.433415 -0.0073537942 0.0014064787 
  990000    1.5252434 -0.00050125744 0.0015089952 
 1000000    1.2351493 -0.0037877047 0.0012154262 
 1000011      1.21292 -0.0031198233 0.0011946977 
Loop time of 12.3475 on 8 procs for 1000000 steps with 100 atoms

Performance: 34986834.098 tau/day, 80988.042 timesteps/s
99.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.1814     | 0.18883    | 0.19242    |   0.8 |  1.53
Neigh   | 0.61938    | 0.62431    | 0.63174    |   0.5 |  5.06
Comm    | 7.5985     | 7.6592     | 7.7186     |   1.3 | 62.03
Output  | 0.0024965  | 0.0039491  | 0.014056   |   6.1 |  0.03
Modify  | 3.4711     | 3.5336     | 3.6125     |   2.1 | 28.62
Other   |            | 0.3376     |            |       |  2.73

Nlocal:        12.5000 ave          18 max           7 min
Histogram: 2 0 2 0 0 0 1 0 1 2
Nghost:        14.1250 ave          16 max          12 min
Histogram: 2 0 1 0 0 1 0 2 0 2
Neighs:       0.625000 ave           2 max           0 min
Histogram: 5 0 0 0 0 1 0 0 0 2

Total # of neighbors = 5
Ave neighs/atom = 0.050000000
Neighbor list builds = 50000
Dangerous builds not checked
write_restart   restart/in.nvt.dens_${rho}                      #Write the ending simulation conditions to a restart file
write_restart   restart/in.nvt.dens_0.001                      
System init for write_restart ...
Total wall time: 0:00:12
